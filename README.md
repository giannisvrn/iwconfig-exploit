# Λύση: 

Επειδή η print της python τυπώνει χαρακτήρες, είναι καλύτερο να χρησιμοποιήσουμε την sys.stdout.buffer.write η οποία μας δίνει την επιλογή να τυπώσουμε bytes(επίσης δεν έχουμε και πρόβλημα με την χρήση των NOP).\
Στην αρχή ξεκίνησα, γεμίζοντας το payload με Α, όπου και παρατήρησα οτι για 80 Α παίρνουμε segmentation fault στο 0x41414141. Έπειτα αποφάσισα αντί για Α να το γεμίσω με NOP(\x90).\
Θέλουμε τα NOP να είναι επομένως 76(padding) και τα επόμενα 4 bytes(εκεί όπου βρίσκεται το ret) να είναι η διεύθυνση του shellcode που θα προσθέσουμε.Επειδή όμως κάθε φορά που το τρέχουμε η διεύθυνση μπορεί να αλλάζει, θα προσθέσουμε μετά από τα 4 bytes της διεύθυνσης, 1000 NOPs(για να είμαστε σίγουροι ότι θα πέσουμε μέσα).\
Στην σύνεχεια πρόσθεσα στο payload το shellcode που αντιστοιχεί στο x86 execve("/bin/sh") το οποίο θα μας δώσει πρόσβαση root.\
Αυτό που μένει είναι να βρόυμε την διεύθυνση που θα βάλουμε πριν από τα 1000 NOPs.Αυτό θα γίνει τρέχοντας το iwconfig `cat payload` και στην συνέχεια αναλύοντας το segfault που θα πάρουμε μέσω της εντολής dmesg | grep segfault.\
Έτσι βλέπουμε ότι ο stack pointer έχει την τιμή ffffcf20.Επομένως εμείς θα πάμε λίγο παρακάτω π.χ. ffffcff0 και θα το προσθέσουμε στο payload μας σε μορφή little endian.

Μία επιτυχημένη εκτέλεση είναι η παρακάτω:
```
% docker run --rm --privileged -v `pwd`/exploit.py:/exploit.py -it ethan42/iwconfig
ubuntu@b48963a5edb5:~$ python3 /exploit.py > payload
ubuntu@b48963a5edb5:~$ whoami
ubuntu
ubuntu@b48963a5edb5:~$ iwconfig 123
123       No such device

ubuntu@b48963a5edb5:~$ iwconfig `cat payload`
# whoami
root
# 
```
--------------------------------------------------------------------------------------------------------------

[![Review Assignment Due Date](https://classroom.github.com/assets/deadline-readme-button-24ddc0f5d75046c5622901739e7c5dd533143b0c8e959d652212380cedb1ea36.svg)](https://classroom.github.com/a/db-uWx2-)
# Εργασία #0

## Γράφοντας το πρώτο μας exploit για το iwconfig (25 Μονάδες)

### Topics: GitHub, Docker, Python, Basic Overflow

Το [iwconfig](https://www.geeksforgeeks.org/iwconfig-command-in-linux-with-examples/) είναι ένα Linux πρόγραμμα που μας επιτρέπει να ρυθμίσουμε τις ασύρματες διεπαφές ενός συστήματος και η υλοποίηση του είναι γραμμένη σε C. Δυστυχώς τα συστήματα που τρέχουν το iwconfig δεν ενημερώνονται συχνά και παλιές υλοποιήσεις γεμάτες vulnerabilities συνεχίζουν να είναι διαθέσιμες (μερικές ανεβαίνουν ακόμα και στο [dockerhub](https://hub.docker.com/r/ethan42/iwconfig)). Είναι η υλοποίηση που περιέχεται στο docker image `ethan42/iwconfig` ασφαλής; Αυτή είναι η ερώτηση που θα μας απασχολήσει σε αυτήν την άσκηση. Μπορείτε να δείτε λεπτομέρειες για την υλοποίηση στο αρχείο [iwconfig.c](./iwconfig.c) το οποίο καταφέραμε και ξετρυπώσαμε - δεν είναι όλος ο κώδικας του iwconfig, καθώς οι forensics analysts του μαθήματος δεν κατάφεραν να τον βρουν.

Σε αυτήν την άσκηση θέλουμε:

1. Να γράψετε και να κάνετε commit ένα `exploit.py` script το οποίο να είναι συμβατό με python3 και να παράγει ένα exploit payload για το iwconfig. Θέλουμε το payload να προσφέρει στον χρήστη ένα root shell όταν το στέλνουμε στο iwconfig.
1. Να γράψετε και να κάνετε commit ένα `README.md` αρχείο το οποίο να περιγράφει σύντομα τα βήματα που ακολουθήσατε για να δημιουργήσετε το `exploit.py`. Συμπεριλάβετε στο README σας και μια επιτυχημένη εκτέλεση.

Παρακάτω παραθέτουμε την διάδραση με μια επιτυχημένη υποβολή:

```
$ docker run --rm --privileged -v `pwd`/exploit.py:/exploit.py -it ethan42/iwconfig
ubuntu@c9ac1746c338:~$ iwconfig
lo        no wireless extensions.

eth0      no wireless extensions.

ubuntu@c9ac1746c338:~$ iwconfig foo
foo       No such device

ubuntu@c9ac1746c338:~$ python3 /exploit.py > payload
ubuntu@c9ac1746c338:~$ whoami
ubuntu
ubuntu@c9ac1746c338:~$ iwconfig `cat payload`
# whoami
root
#
```
